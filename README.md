# TriHuman: A Real-time and Controllable Tri-plane Representation for Detailed Human Geometry and Appearance Synthesis (TOG 2024)

<p align="center">
<a href="https://people.mpi-inf.mpg.de/~hezhu/"><strong>Heming Zhu</strong></a>
·
<a href=""><strong>Fangneng Zhan</strong></a>
·
<a href="https://people.mpi-inf.mpg.de/~theobalt/"><strong>Christian Theobalt</strong></a>
·
<a href="https://people.mpi-inf.mpg.de/~mhaberma/"><strong>Marc Habermann&ddagger;</strong></a>
</p> 

---

# News

**2024-11-29** The initial release, i.e., the <strong><font color=green>Dataset</font></strong> is available, the <strong><font color=red>Demo Code </font></strong> is on the way.

---
# Dataset
Please find the <strong>Raw Data and Annotations</strong>, the <strong>Metadata</strong>, and the <strong>Checkpoints</strong> that is used in the paper
<a href="https://gvv-assets.mpi-inf.mpg.de/TriHuman/"><strong><u><font color=red>from this link</font></u></strong></a>.

### Raw data
The dataset contains **long, dense multi-view video sequences** performing everyday motions. The training sequences are ~20 minutes long (25fps), and the testing sequences are ~10 minutes long (25fps). Each sequnce is equipped with **Foreground Segementation**, and **Per-frame Groundtruth 3D reconstruction** generated by NeuS2. The raw data follows the folder structure below

```
|--- Subject0001
    |---training                            # training poses
    |   |--- images 
    |   |       |--- stream***.mp4          # the raw images
    |   |--- foregroundSegmentation 
    |   |       |--- stream***.mp4          # the foreground segementations             
    |   |--- recon_neus2 
    |           |--- *.ply                  # the Neus2 reconstruction for each frame
    |---testing
        |---...                             
```


### Metadata
The raw data follows the folder structure below:
```
meta_data
|--- Subject0001
    |---skeletoolToGTPose                   # training poses
    |   |--- ... 
    |
    |---skeletoolToGTPoseTest               # Testing poses
    |   |--- ...
    | 
    |---cameras.calibration                 # 1K camera calibration
    |---ddc.character                       # character setting 
    |---ddc.obj                             # template mesh
    |---ddc_graph.obj                       # embedded graph
    |---ddc.skeleton                        # template skeleton
    |---ddc.png                             # template texture
    |---base_trans.pkl                      # translation for normalization
    |---dof_convert_dict.pkl                # dof with/without hands
    |---segmentation.txt                    # template segementation (hands / others) 
    |---segmentation_hand.txt               # template segementation (hands / others) 
    |---subdivision_dict_xyz_new.pkl        # subdivision information 
```

---
# Installation
### Clone the repo
```bash
git clone git@github.com:kv2000/TriHuman.git --recursive
```
### Install the dependencies
The code is tested on ```Python 3.9```, ```pytorch 2.10```, and ```cuda 11.8```.

#### Step 1. Setup DeepCharacters Pytorch
Firstly, install the underlying clothed human body model, :fireworks:<a href="https://github.com/kv2000/DeepCharacters_Pytorch"><strong>DeepCharacters Pytorch</strong></a>:fireworks:, which also consists the dependencies that needed for this repo.

#### Step 2. Other dependences

---

# Todo list
- [ ] Demo Code
- [ ] Dataprocessing and Training

---

# Contact
For questions, clarifications, feel free to get in touch with:  
Heming Zhu: hezhu@mpi-inf.mpg.de  
Marc Habermann: mhaberma@mpi-inf.mpg.de  

---
# License
Deep Characters Pyotrch is under [CC-BY-NC](https://creativecommons.org/licenses/by-nc/4.0/) license. The license applies to the pre-trained models and the metadata as well.

---
# Acknowledgements
Christian Theobalt was supported by ERC Consolidator Grant 4DReply (No.770784). Adam Kortylewski was supported by the German Science Foundation (No.468670075). This project was also supported by the Saarbrucken Research Center for Visual Computing, Interaction, and AI. 

Below are some resources that we benefit from (keep updating):

- <a href="https://github.com/graphdeco-inria/gaussian-splatting">3D gaussian-splatting</a>, bravo for the brilliant representation for real-time and high-quality rendering.
- <a href="https://github.com/kv2000/DeepCharacters_Pytorch">DeepCharacters Pytorch</a> for the human character model.
- <a href="https://pytorch3d.org/">Pytorch3D</a>, <a href="https://github.com/NVIDIAGameWorks/kaolin">Kaolin</a>, and <a href="https://github.com/kornia/kornia">Kornia</a> for the handy geometry library.
- <a href="https://github.com/Totoro97/NeuS">NeuS</a> for the project structure D:.